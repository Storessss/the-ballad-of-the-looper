[gd_scene load_steps=12 format=3 uid="uid://b4vyf0b25ms8r"]

[ext_resource type="PackedScene" uid="uid://7vv71sj61141" path="res://scenes/enemies/enemy.tscn" id="1_ecoe6"]
[ext_resource type="Script" uid="uid://cqpqxv2ghcfp6" path="res://scenes/enemies/turret.gd" id="2_oabpu"]
[ext_resource type="Texture2D" uid="uid://j2tiem5jxhkq" path="res://sprites/turret_empty.png" id="2_ue2uv"]
[ext_resource type="Texture2D" uid="uid://cfjd5rr4lrbnx" path="res://sprites/turret_pupil.png" id="3_oabpu"]
[ext_resource type="Script" uid="uid://dlg1ayvyypn8j" path="res://scenes/enemies/state_machine/states/IfInRange.gd" id="5_w2i2w"]
[ext_resource type="Script" uid="uid://bh3y3p6ms0ngx" path="res://scenes/enemies/state_machine/states/ShootBullet.gd" id="6_d5tah"]
[ext_resource type="PackedScene" uid="uid://b7hpvroesff1n" path="res://scenes/bullets/red_bullet.tscn" id="7_kr03i"]
[ext_resource type="Script" uid="uid://br3jn01nyuwcx" path="res://scenes/enemies/state_machine/states/Idle.gd" id="8_0rpki"]

[sub_resource type="SpriteFrames" id="SpriteFrames_wqsho"]
animations = [{
"frames": [{
"duration": 1.0,
"texture": ExtResource("2_ue2uv")
}],
"loop": true,
"name": &"default",
"speed": 5.0
}]

[sub_resource type="CapsuleShape2D" id="CapsuleShape2D_ecoe6"]
radius = 4.0
height = 18.0

[sub_resource type="CapsuleShape2D" id="CapsuleShape2D_ue2uv"]
radius = 3.0
height = 14.0

[node name="Turret" instance=ExtResource("1_ecoe6")]
script = ExtResource("2_oabpu")
health = 60
contact_damage = true
nav_agent_movement = false
min_dim_drop = 2
max_dim_drop = 3

[node name="AnimatedSprite2D" parent="." index="0"]
position = Vector2(0, -1)
scale = Vector2(1.2, 1.2)
sprite_frames = SubResource("SpriteFrames_wqsho")
autoplay = "default"

[node name="Pupil" type="Sprite2D" parent="." index="1"]
position = Vector2(0, -7)
scale = Vector2(1.2, 1.2)
texture = ExtResource("3_oabpu")

[node name="CollisionShape2D" parent="." index="2"]
shape = SubResource("CapsuleShape2D_ecoe6")

[node name="CollisionShape2D" parent="Area2D" index="0"]
shape = SubResource("CapsuleShape2D_ue2uv")

[node name="CastPoint" parent="." index="5"]
position = Vector2(0, -7)

[node name="FSM" parent="." index="7" node_paths=PackedStringArray("initial_state")]
initial_state = NodePath("Idle")

[node name="Idle" type="Node" parent="FSM" index="0" node_paths=PackedStringArray("next_state")]
script = ExtResource("8_0rpki")
state_duration_min = 0.5
state_duration_max = 0.5
next_state = NodePath("../IfInRange")

[node name="IfInRange" type="Node" parent="FSM" index="1" node_paths=PackedStringArray("next_state", "exit_state")]
script = ExtResource("5_w2i2w")
trigger_distance = 170
exit_distance = 200
next_state = NodePath("../Idle2")
exit_state = NodePath("../Idle")

[node name="Idle2" type="Node" parent="FSM" index="2" node_paths=PackedStringArray("next_state")]
script = ExtResource("8_0rpki")
state_duration_min = 1.5
state_duration_max = 1.5
next_state = NodePath("../ShootBullet")

[node name="ShootBullet" type="Node" parent="FSM" index="3" node_paths=PackedStringArray("next_state")]
script = ExtResource("6_d5tah")
bullet_scene = ExtResource("7_kr03i")
bullet_count = 7
auto_target_player_before_shooting = true
sound = "shoot"
next_state = NodePath("../IfInRange")
